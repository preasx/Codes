<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>My Diary Book</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Georgia', serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; background: #d9c7a7; }
  #book-container { width: 100vw; height: 100vh; display: flex; flex-direction: column; position: fixed; top:0; left:0; right:0; bottom:0; background: #fefdf5; border:1px solid #b39f7a; overflow: hidden; }
  #page-content { flex: 1; white-space: pre-wrap; font-size: 11pt; line-height: 1.6; padding: 20px; text-align: left; font-family: 'Georgia', serif; background-image: linear-gradient(rgba(0,0,0,0.05) 0.1em, transparent 0.1em); background-size: 100% 1.6em; background-position: 0 1.4em; opacity:0; transform: translateX(50px); transition: all 0.8s ease; }
  #page-content.show { opacity:1; transform: translateX(0); }
  .nav-buttons { display: flex; justify-content: space-between; align-items: center; padding: 8px 15px; height: 50px; border-top:1px solid #e5d9bc; background: linear-gradient(to bottom, #fefdf5 0%, #f5ecd5 100%); }
  button { padding: 6px 12px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-family: 'Georgia', serif; height: 34px; background: #7a3c12; color:#fff; transition: all 0.3s ease; }
  button:hover:not(:disabled){ background:#5d2d0a; transform: translateY(-2px); box-shadow:0 4px 8px rgba(0,0,0,0.2); }
  button:disabled { cursor:not-allowed; opacity:0.5; }
  #page-indicator { font-size: 13px; font-style: italic; font-weight: bold; color:#7a3c12; }
  .chapter-page { display:flex; flex-direction:column; justify-content:center; align-items:center; height:100%; text-align:center; }
  .chapter-title { font-size:24px; margin-bottom:10px; color:#7a3c12; }
  .chapter-subtitle { font-size:16px; font-style:italic; color:#8d6e63; }
</style>
</head>
<body>

<div id="book-container">
  <div id="page-content"><div class="loading">Loading your diary content...</div></div>
  <div class="nav-buttons">
    <button id="prevBtn" onclick="prevPage()">⬅ Previous</button>
    <div id="page-indicator">Page 1</div>
    <button id="nextBtn" onclick="nextPage()">Next ➡</button>
  </div>
</div>

<script>
const chapters = [
  { title: "Chapter 1: The Beginning", url: "chapters/chapter1.txt" },
  { title: "Chapter 2: Growing Up", url: "chapters/chapter2.txt" }
];

let pages = [];
let currentPage = 0;
const wordsPerPage = 500;
let fontSize = 11;
let unlockTimer = null;

// create chapter intro
function createChapterPage(title) {
  return { isChapterPage:true, content:title };
}

// split + paginate
function splitText(text) {
  return text.split(/\s+/);
}
function paginateContent(text, title) {
  const words = splitText(text);
  const pagesArr = [createChapterPage(title)];
  for (let i=0;i<words.length;i+=wordsPerPage) {
    pagesArr.push({ isChapterPage:false, content: words.slice(i,i+wordsPerPage).join(" ") });
  }
  return pagesArr;
}

// load chapters
async function loadChapters(){
  pages=[];
  for(const ch of chapters){
    try{
      const res=await fetch(ch.url);
      const text=await res.text();
      pages=pages.concat(paginateContent(text,ch.title));
    }catch(e){
      pages.push({isChapterPage:false,content:"Error loading "+ch.title});
    }
  }
  renderPage();
}

// render
function renderPage(){
  const page=pages[currentPage];
  const content=document.getElementById("page-content");
  content.classList.remove("show");
  setTimeout(()=>{
    if(page.isChapterPage){
      content.innerHTML=`<div class="chapter-page"><div class="chapter-title">${page.content}</div><div class="chapter-subtitle">Enjoy reading ❤</div></div>`;
    }else{
      content.textContent=page.content;
    }
    content.style.fontSize=`${fontSize}pt`;
    requestAnimationFrame(()=>content.classList.add("show"));
  },200);

  document.getElementById("page-indicator").textContent="Page "+(currentPage+1);
  document.getElementById("prevBtn").disabled=currentPage===0;
  document.getElementById("nextBtn").disabled=true; // lock next

  // unlock after 30s
  if(unlockTimer) clearTimeout(unlockTimer);
  unlockTimer=setTimeout(()=>{
    if(currentPage<pages.length-1){
      document.getElementById("nextBtn").disabled=false;
    }
  },30000);
}

function nextPage(){
  if(currentPage<pages.length-1){
    currentPage++;
    renderPage();
  }
}
function prevPage(){
  if(currentPage>0){
    currentPage--;
    renderPage();
  }
}

loadChapters();
</script>
</body>
</html>